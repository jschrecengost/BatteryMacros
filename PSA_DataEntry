Private Sub CommandButton1_Click()

Dim con As ADODB.Connection
Dim rs As ADODB.Recordset
Set con = New ADODB.Connection

Dim sampleName As String
sampleName = "'" + TextBox01.Text + "'"

Dim sampleLetter As String
sampleLetter = "'" + TextBox02.Text + "'"

Dim sampleType As String
sampleType = "'" + TextBox03.Text + "'"

Dim description As String
description = "'" + TextBox04.Text + "'"

Dim ExperimentID As String
ExperimentID = "'" + TextBox05.Text + "'"

Dim fileName As String
fileName = "'" + TextBox06.Text + "'"

Dim measurementDate As String
measurementDate = "'" + Format(TextBox07.Text, "yyyy-MM-dd") + "'"

Dim measurementOperator As String
measurementOperator = "'" + TextBox08.Text + "'"

Dim notebookNumber As String
notebookNumber = "'" + TextBox09.Text + "'"

Dim Notes As String
Notes = "'" + TextBox10.Text + "'"

Dim dx10 As String
dx10 = "'" + TextBox11.Text + "'"

Dim dx50 As String
dx50 = "'" + TextBox12.Text + "'"

Dim dx90 As String
dx90 = "'" + TextBox13.Text + "'"

Dim Sql As String
Sql = ""

'Sql = CDate(TextBox07.Text).toString("yyyy-MM-dd")
'Above line shows how to convert an unformatted date string to a MySQL format string

con.Open "Driver={MySQL ODBC 8.0 Unicode Driver}; Server = 10.10.240.151; Database=battery;User=battery;Password=3point14;"

Sql = "insert into battery.analysis_particle_sizing"

Sql = Sql + "(sample_name,sample_letter,sample_type,description,experimentID,filename,"
Sql = Sql + "measurement_date,measurement_operator,notebook_number,notes,Dx10,Dx50,Dx90)"
Sql = Sql + " values(" & sampleName & ",'" & TextBox02.Text & "','" & TextBox03.Text
Sql = Sql + "','" & TextBox04.Text & "','" & TextBox05.Text & "','" & TextBox06.Text
Sql = Sql + "'," & measurementDate & ",'" & TextBox08.Text & "','" & TextBox09.Text
Sql = Sql + "','" & TextBox10.Text & "'," & dx10 & ",'" & TextBox12.Text
Sql = Sql + "','" & TextBox13.Text & "');"

'MsgBox Sql
'Above line displays a messagebox with the current value of the variable Sql

con.Execute Sql
con.Close
MsgBox "Done!"

End Sub


